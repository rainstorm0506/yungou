 /**************************************************************

 @Name : layer v1.5.1 弹层组件压缩版
 @author: 贤心
 @date: 2013-04-17
 @blog: http://sentsin.com
 @微博：http://weibo.com/SentsinXu
		http://t.qq.com/xian_xin
 @QQ群：176047238(layer交流群)
 @Copyright: Sentsin Xu(贤心)
 @官网说明：http://sentsin.com/jquery/layer
 @赞助layer: https://me.alipay.com/sentsin
		
 *************************************************************/

;void function(b,e){
var c=true, //是否采用自动获取绝对路径。如false：将采用下述变量中的配置
f="../../lily/lib/layer/",  //当前js所在路径，上述变量为false才有效
d=function(){var j=jQuery,g=j(b),i={getPath:function(){var l=document.scripts||j("script"),k=l[l.length-1].src;return k.substring(0,k.lastIndexOf("/")+1)},append:function(){c&&(f=this.getPath());var k=j("head")[0],l=document.createElement("link");l.setAttribute("type","text/css");l.setAttribute("rel","stylesheet");l.setAttribute("href",f+"skin/layer.css");k.appendChild(l)},global:{iE6:!-[1,]&&!b.XMLHttpRequest,times:0}};b.layer={v:"1.5.1",ready:function(l){var k="#layerCss";return j(k).ready(function(){l()})},alert:function(l,m,n,k){return j.layer({dialog:{msg:l,type:m,yes:k},title:n,area:["auto","auto"]})},confirm:function(l,k,m,n){return j.layer({dialog:{msg:l,type:4,btns:2,yes:k,no:n},title:m})},msg:function(m,l,k,n){(m==""||m==e)&&(m="&nbsp;");(l==e||l=="")&&(l=2);return j.layer({dialog:{msg:m,type:k},time:l,title:["",false],closeBtn:["",false],end:function(){n&&n()}})},tips:function(m,l,p,o,k,n){return j.layer({type:4,shade:false,time:p,maxWidth:o,tips:{msg:m,guide:k,follow:l,style:n}})},load:function(l,n,k){var m=true;n===3&&(m=false);return j.layer({time:l,shade:k,loading:{type:n},border:[10,0.3,"#000",m],type:3,title:["",false],closeBtn:[0,false]})}};var h=function(l){i.global.times++;this.index=i.global.times;var k=this.config;this.config=j.extend({},k,l);this.config.dialog=j.extend({},k.dialog,l.dialog);this.config.page=j.extend({},k.page,l.page);this.config.iframe=j.extend({},k.iframe,l.iframe);this.config.loading=j.extend({},k.loading,l.loading);this.config.tips=j.extend({},k.tips,l.tips);this.adjust()};h.pt=h.prototype;h.pt.config={skin:0,type:0,shade:[0.5,"#000",true],shadeClose:false,fix:true,move:[".xubox_title",true],title:["信息",true],offset:["200px","50%"],area:["310px","auto"],closeBtn:[0,true],time:0,border:[10,0.3,"#000",true],zIndex:19891014,maxWidth:400,fadeIn:[300,false],dialog:{btns:1,btn:["确定","取消"],type:3,msg:"",yes:function(k){layer.close(k)},no:function(k){layer.close(k)}},page:{dom:"#xulayer",html:""},iframe:{src:"http://sentsin.com"},loading:{type:0},tips:{msg:"",follow:"",guide:0,style:["background-color:#FF9900; color:#fff;","#FF9900"]},success:function(k){},close:function(k){layer.close(k)},end:function(){}};h.pt.type=["dialog","page","iframe","loading","tips"];h.pt.space=function(p){var p=p||"",k=this.index,m=this.config,q=m.dialog,l=['<div class="xubox_dialog"><span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype'+q.type+'"></span><span class="xubox_msg xubox_text">'+q.msg+"</span></div>",'<div class="xubox_page xubox_page_'+m.skin+'">'+p+"</div>",'<iframe allowtransparency="true" id="xubox_iframe" name="xubox_iframe" onload="javascript:$(\'.xubox_layer\').find(\'.xubox_iframe\').removeClass(\'xubox_load\');" class="xubox_iframe" frameborder="0" src="'+m.iframe.src+'"></iframe>','<span class="xubox_loading xubox_loading_'+m.loading.type+'"></span>','<div class="xubox_tips xubox_tips_'+m.skin+'" style="'+m.tips.style[0]+'"><div class="xubox_tipsMsg">'+m.tips.msg+'</div><i class="layerTipsG"></i></div>'];var s="",n="";this.zIndex=m.zIndex+k;var r=this.zIndex,t="z-index:"+r+"; background-color:"+m.shade[1]+"; opacity:"+m.shade[0]+"; filter:alpha(opacity="+m.shade[0]*100+");";m.shade[2]&&(s='<div times="'+k+'" id="xubox_shade'+k+'" class="xubox_shade xubox_shade_'+m.skin+'" style="'+t+'"></div>');var u="z-index:"+(r-1)+";  background-color: "+m.border[2]+"; opacity:"+m.border[1]+"; filter:alpha(opacity="+m.border[1]*100+"); top:-"+m.border[0]+"px; left:-"+m.border[0]+"px;";m.border[3]&&(n='<div id="xubox_border'+k+'" class="xubox_border" style="'+u+'"></div>');var o='<div times="'+k+'" showtime="'+m.time+'" style="z-index:'+r+'" id="xubox_layer'+k+'" class="xubox_layer xubox_layer_'+m.skin+'"><div style="z-index:'+r+'" class="xubox_main xubox_main_'+m.skin+'">'+l[m.type]+'<h2 class="xubox_title xubox_title_'+m.skin+'"><em>'+m.title[0]+'</em></h2><a class="xubox_close xulayer_png32 xubox_close'+m.closeBtn[0]+"_"+m.skin+'" href="javascript:;"></a><span class="xubox_botton"></span></div>'+n+"</div>";return[s,o]};h.pt.adjust=function(){var m=this,k="",n=this.config,r=n.dialog,s=m.config.title;s.constructor===Array||(m.config.title=[s,true]);s===false&&(m.config.title=[s,false]);var q=n.page,p=function(u){var u=u||"";k=m.space(u);j("body").append(k[0])};switch(n.type){case 1:if(q.html!==""){p('<div id="xuboxPageHtml">'+q.html+"</div>");j("body").append(k[1])}else{if(j(q.dom).parents(".xubox_page").length==0){p();j(q.dom).show().wrap(k[1])}else{return false}}break;case 2:j(".xubox_layer").find(".xubox_iframe").length>0&&layer.close(j(".xubox_iframe").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break;case 3:n.title=["",false];n.area=["auto","auto"];n.closeBtn=["",false];j(".xubox_layer").find(".xubox_loading").length>0&&layer.close(j(".xubox_loading").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break;case 4:n.title=["",false];n.area=["auto","auto"];n.fix=false;n.border=[0,0,0,false];j(".xubox_layer").find(".xubox_tips").length>0&&layer.close(j(".xubox_tips").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);j(".xubox_tips").fadeIn(200).parents(".xubox_layer").find(".xubox_close").css({top:5,right:5});break;default:n.title[1]||(n.area=["auto","auto"]);j(".xubox_layer").find(".xubox_dialog").length>0&&layer.close(j(".xubox_dialog").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break}var l=i.global.times;this.layerS=j("#xubox_shade"+l);this.layerB=j("#xubox_border"+l);this.layerE=j("#xubox_layer"+l);var o=this.layerE;if(n.offset[1].indexOf("px")!=-1){var t=parseInt(n.offset[1])}else{if(n.offset[1]=="50%"){var t=n.offset[1]}else{var t=parseInt(n.offset[1])/100*g.width()}}o.css({left:t+n.border[0],width:n.area[0],height:n.area[1]});n.fix?o.css({top:parseInt(n.offset[0])+n.border[0]}):o.css({top:parseInt(n.offset[0])+g.scrollTop()+n.border[0],position:"absolute"});this.layerMian=o.find(".xubox_main");this.layerTitle=o.find(".xubox_title");this.layerText=o.find(".xubox_text");this.layerPage=o.find(".xubox_page");this.layerBtn=o.find(".xubox_botton");if(n.type==0&&n.title[1]){switch(r.btns){case 0:this.layerBtn.html("").hide();break;case 2:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton2_'+n.skin+'">'+r.btn[0]+'</a><a href="javascript:;" class="xubox_no xubox_botton3_'+n.skin+'">'+r.btn[1]+"</a>");break;default:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton1_'+n.skin+'">'+r.btn[0]+'</a><a class="xubox_no" style="displa:none;"></a>')}}if(o.css("left")==="auto"){o.hide();setTimeout(function(){o.show();m.pagetype(l)},500)}else{this.pagetype(l)}this.callback()};h.pt.pagetype=function(s){var u=this,o=this.layerE,A=this.config,n=A.page;u.autoArea(s);A.time<=0||this.autoclose();A.move[1]?o.find(".xubox_title").css({cursor:"move"}):o.find(".xubox_title").css({cursor:"auto"});A.closeBtn[1]||o.find(".xubox_close").remove().hide();if(!A.title[1]){o.find(".xubox_title").remove().hide();A.type!=4&&o.find(".xubox_close").removeClass("xubox_close0_"+A.skin).addClass("xubox_close1_"+A.skin)}else{this.layerTitle.css({width:o.outerWidth()})}A.border||o.removeClass("xubox_layerBoder");var r=parseInt(this.layerMian.css("margin-right")),B=parseInt(o.css("padding-bottom"));o.attr({type:u.type[A.type]});switch(A.type){case 1:o.find(n.dom).addClass("layer_pageContent");this.layerPage.css({width:o.width()-2*r});A.shade&&o.css({"z-index":u.zIndex+1});A.title[1]?this.layerPage.css({top:r+this.layerTitle.outerHeight()}):this.layerPage.css({top:r});break;case 2:o.find(".xubox_iframe").addClass("xubox_load").css({width:o.width()-2*r});A.title[1]?o.find(".xubox_iframe").css({top:this.layerTitle.height()+B,height:o.height()-this.layerTitle.height()}):o.find(".xubox_iframe").css({top:B,height:o.height()});i.global.iE6&&o.find("#xubox_iframe").attr("src",A.iframe.src);break;case 4:var v=j(A.tips.follow),x=v.offset().top,t=x-o.outerHeight();var k=v.offset().left,l=k,w=A.tips.style[1];var z=v.outerHeight(),p=v.outerWidth(),y=o.find(".layerTipsG");p>y.maxWidth&&v.width(A.maxWidth);if(A.tips.guide===1){var q=g.width()-l-p-o.outerWidth()-10,t=x;if(q>0){l=l+v.outerWidth()+10;y.removeClass("layerTipsL").addClass("layerTipsR").css({"border-right-color":w})}else{l=l-o.outerWidth()-10;y.removeClass("layerTipsR").addClass("layerTipsL").css({"border-left-color":w})}}else{if(t-g.scrollTop()-12<=0){t=x+z+10;y.removeClass("layerTipsT").addClass("layerTipsB").css({"border-bottom-color":w})}else{t=t-10;y.removeClass("layerTipsB").addClass("layerTipsT").css({"border-top-color":w})}}o.css({top:t,left:l});break;default:this.layerMian.css({"background-color":"#fff"});if(A.title[1]){this.layerText.css({paddingTop:18+this.layerTitle.outerHeight()})}else{o.find(".xubox_msgico").css({top:"10px"});this.layerText.css({marginTop:12})}break}var m=0;A.fadeIn[1]&&(m=A.fadeIn[0]);o.animate({opacity:1,filter:"alpha(opacity="+100+")"},m);this.move()};h.pt.autoArea=function(l){var n=this,s=j("#xubox_layer"+l),o=this.config,u=o.page,p=s.find(".xubox_main"),m=s.find(".xubox_botton"),q=s.find(".xubox_text"),k=s.find(".xubox_page"),t=j("#xubox_border"+l);if(o.area[0]=="auto"&&p.outerWidth()>=o.maxWidth){s.css({width:o.maxWidth})}o.title[1]?titHeight=s.find(".xubox_title").innerHeight():titHeight=0;switch(o.type){case 0:var v=m.find("a"),w=q.outerHeight()+20;if(v.length>0){var r=m.find("a").outerHeight()+20}else{var r=0}break;case 1:var r=0,w=j(u.dom).outerHeight();o.area[0]=="auto"&&s.css({width:k.outerWidth()});break;case 3:var r=0;var w=j(".xubox_loading").outerHeight();p.css({width:j(".xubox_loading").width()});break}(o.offset[1]=="50%"||o.offset[1]=="")&&(o.type!==4)?s.css({marginLeft:-s.outerWidth()/2}):s.css({marginLeft:0});(o.area[1]=="auto")&&p.css({height:titHeight+w+r});t.css({width:s.outerWidth()+2*o.border[0],height:s.outerHeight()+2*o.border[0]});(i.global.iE6&&o.area[0]!="auto")&&p.css({width:s.outerWidth()})};h.pt.move=function(){var m=this.config,l=this.layerE.find(m.move[0]),r,o;var p,n,k,q=0;m.move[1]&&l.attr("move","ok");j(m.move[0]).on("mousedown",function(w){w.preventDefault();if(j(this).attr("move")==="ok"){o=true;r=j(this).parents(".xubox_layer"),index=r.attr("times");var u=r.offset().left,v=r.offset().top,t=r.width()-6,s=r.height()-6;if(!j("#xubox_moves")[0]){j("body").append('<div id="xubox_moves" class="xubox_moves" style="left:'+u+"px; top:"+v+"px; width:"+t+"px; height:"+s+'px; z-index:30000000"></div>')}k=j("#xubox_moves");p=w.pageX-k.position().left;n=w.pageY-k.position().top;r.css("position")!=="fixed"||(q=g.scrollTop())}});j(document).mousemove(function(u){if(o){u.preventDefault();var s=u.pageX-p;if(r.css("position")==="fixed"){var t=u.pageY-n}else{var t=u.pageY-n}k.css({left:s,top:t})}}).mouseup(function(){if(o){if(parseInt(r.css("margin-left"))==0){var s=parseInt(k.css("left"))}else{var s=parseInt(k.css("left"))+(-parseInt(r.css("margin-left")))}r.css("position")==="fixed"||(s=s-r.parent().offset().left);r.css({left:s,top:parseInt(k.css("top"))-q});k.remove()}o=false})};h.pt.autoclose=function(){var l=this,m=this.config.time;var k=function(){m--;if(m===0){layer.close(l.index);clearInterval(l.autotime)}};this.autotime=setInterval(k,1000)};i.config={end:{}};h.pt.callback=function(){this.openLayer();var m=this,n=this.layerE,k=this.config,l=k.dialog;this.config.success(n);i.global.iE6&&this.IE6();n.find(".xubox_close").off("click").on("click",function(o){o.preventDefault();k.close(m.index)});n.find(".xubox_yes").off("click").on("click",function(o){o.preventDefault();l.yes(m.index)});n.find(".xubox_no").off("click").on("click",function(o){o.preventDefault();l.no(m.index)});this.layerS.off("click").on("click",function(o){o.preventDefault();m.config.shadeClose&&layer.close(m.index)});i.config.end[this.index]=k.end};h.pt.IE6=function(){var n=this,o=this.layerE,k=j("select");var m=o.offset().top;if(this.config.fix){var l=function(){o.css({top:j(document).scrollTop()+m})}}else{var l=function(){o.css({top:m})}}l();g.scroll(l);j.each(k,function(p,q){var r=j(this);if(!r.parents(".xubox_layer")[0]){r.css("display")=="none"||r.attr({layer:"1"}).hide()}});this.reselect=function(){j.each(k,function(p,q){var r=j(this);if(!r.parents(".xubox_layer")[0]){(r.attr("layer")==1&&j(".xubox_layer").length<1)&&r.removeAttr("layer").show()}})}};h.pt.openLayer=function(){var k=this;layer.autoArea=function(l){return k.autoArea(l)};layer.getIndex=function(l){return j(l).parents(".xubox_layer").attr("times")};layer.getChildFrame=function(l){return j("#xubox_iframe").contents().find(l)};layer.getFrameIndex=function(){return j("#xubox_iframe").parents(".xubox_layer").attr("times")};layer.iframeAuto=function(){var m=[this.getChildFrame("body").outerWidth(),this.getChildFrame("body").outerHeight()],l=j("#xubox_iframe").parents(".xubox_layer"),p=l.attr("times"),o=l.find(".xubox_title"),q=0;!o||(q=o.height());l.css({width:m[0],height:m[1]+q});o.css({width:m[0]});var n=-parseInt(j("#xubox_border"+p).css("left"));j("#xubox_border"+p).css({width:m[0]+2*n,height:m[1]+2*n+q});j("#xubox_iframe").css({width:m[0],height:m[1]})};layer.close=function(m){var o=j("#xubox_layer"+m),l=j("#xubox_shade"+m);if(o.attr("type")==k.type[1]){if(o.find("#xuboxPageHtml")[0]){o.remove()}else{o.find(".xubox_close,.xubox_botton,.xubox_title,.xubox_border").remove();for(var n=0;n<3;n++){o.find(".layer_pageContent").unwrap().hide()}}}else{!-[1,]||o.find("#xubox_iframe").remove();o.remove()}l.remove();i.global.iE6&&k.reselect();typeof i.config.end[m]==="function"&&i.config.end[m]();delete i.config.end[m]};layer.loadClose=function(){var m=j(".xubox_loading").parents(".xubox_layer"),l=m.attr("times");layer.close(l)};layer.shift=function(s,r){var m=k.config,q=i.global.iE6,o=k.layerE,t=0,p=g.width(),l=g.height();(m.offset[1]=="50%"||m.offset[1]=="")?t=o.outerWidth()/2:t=o.outerWidth();var n={t:{top:m.border[0]},b:{top:l-o.outerHeight()-m.border[0]},cl:t+m.border[0],ct:-o.outerHeight(),cr:p-t-m.border[0],fn:function(){q&&k.IE6()}};switch(s){case"left-top":o.css({left:n.cl,top:n.ct}).animate(n.t,r,n.fn);break;case"right-top":o.css({left:n.cr,top:n.ct}).animate(n.t,r,n.fn);break;case"left-bottom":o.css({left:n.cl,top:l}).animate(n.b,r,n.fn);break;case"right-bottom":o.css({left:n.cr,top:l}).animate(n.b,r,n.fn);break}};layer.setMove=function(){return k.move()}};i.append();j.layer=function(l){var k=new h(l);return k.index}};var a="../../init/jquery";if(typeof define==="function"&&typeof seajs==="object"){define([a],function(h,g,i){d();g.layer=[b.layer,b["$"].layer]})}else{d()}}(window);